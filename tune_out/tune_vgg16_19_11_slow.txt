reading configurations from config file: cfg/tune_vgg16_19_11_slow.cfg
model: vgg16
source model file: D:/Downloads/amazon/bottleneck/vgg16/frozen19_20170704-132538.h5
number of frozen layers: 11
[5e-05, 1e-05, 2e-06]
[20, 5, 3]
batch size: 32
(40479L, 224L, 224L, 3L)
(40479L, 17L)
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
input_1 (InputLayer)             (None, 3, 224, 224)   0                                            
____________________________________________________________________________________________________
block1_conv1 (Convolution2D)     (None, 64, 224, 224)  1792        input_1[0][0]                    
____________________________________________________________________________________________________
block1_conv2 (Convolution2D)     (None, 64, 224, 224)  36928       block1_conv1[0][0]               
____________________________________________________________________________________________________
block1_pool (MaxPooling2D)       (None, 64, 112, 112)  0           block1_conv2[0][0]               
____________________________________________________________________________________________________
block2_conv1 (Convolution2D)     (None, 128, 112, 112) 73856       block1_pool[0][0]                
____________________________________________________________________________________________________
block2_conv2 (Convolution2D)     (None, 128, 112, 112) 147584      block2_conv1[0][0]               
____________________________________________________________________________________________________
block2_pool (MaxPooling2D)       (None, 128, 56, 56)   0           block2_conv2[0][0]               
____________________________________________________________________________________________________
block3_conv1 (Convolution2D)     (None, 256, 56, 56)   295168      block2_pool[0][0]                
____________________________________________________________________________________________________
block3_conv2 (Convolution2D)     (None, 256, 56, 56)   590080      block3_conv1[0][0]               
____________________________________________________________________________________________________
block3_conv3 (Convolution2D)     (None, 256, 56, 56)   590080      block3_conv2[0][0]               
____________________________________________________________________________________________________
block3_pool (MaxPooling2D)       (None, 256, 28, 28)   0           block3_conv3[0][0]               
____________________________________________________________________________________________________
block4_conv1 (Convolution2D)     (None, 512, 28, 28)   1180160     block3_pool[0][0]                
____________________________________________________________________________________________________
block4_conv2 (Convolution2D)     (None, 512, 28, 28)   2359808     block4_conv1[0][0]               
____________________________________________________________________________________________________
block4_conv3 (Convolution2D)     (None, 512, 28, 28)   2359808     block4_conv2[0][0]               
____________________________________________________________________________________________________
block4_pool (MaxPooling2D)       (None, 512, 14, 14)   0           block4_conv3[0][0]               
____________________________________________________________________________________________________
block5_conv1 (Convolution2D)     (None, 512, 14, 14)   2359808     block4_pool[0][0]                
____________________________________________________________________________________________________
block5_conv2 (Convolution2D)     (None, 512, 14, 14)   2359808     block5_conv1[0][0]               
____________________________________________________________________________________________________
block5_conv3 (Convolution2D)     (None, 512, 14, 14)   2359808     block5_conv2[0][0]               
____________________________________________________________________________________________________
block5_pool (MaxPooling2D)       (None, 512, 7, 7)     0           block5_conv3[0][0]               
____________________________________________________________________________________________________
flatten_1 (Flatten)              (None, 25088)         0           block5_pool[0][0]                
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 4096)          102764544   flatten_1[0][0]                  
____________________________________________________________________________________________________
dropout_1 (Dropout)              (None, 4096)          0           dense_1[0][0]                    
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 4096)          16781312    dropout_1[0][0]                  
____________________________________________________________________________________________________
dropout_2 (Dropout)              (None, 4096)          0           dense_2[0][0]                    
____________________________________________________________________________________________________
dense_3 (Dense)                  (None, 17)            69649       dropout_2[0][0]                  
====================================================================================================
Total params: 134,330,193
Trainable params: 132,594,705
Non-trainable params: 1,735,488
____________________________________________________________________________________________________
None
(0, u'input_1', False)
(1, u'block1_conv1', False)
(2, u'block1_conv2', False)
(3, u'block1_pool', False)
(4, u'block2_conv1', False)
(5, u'block2_conv2', False)
(6, u'block2_pool', False)
(7, u'block3_conv1', False)
(8, u'block3_conv2', False)
(9, u'block3_conv3', False)
(10, u'block3_pool', False)
(11, u'block4_conv1', True)
(12, u'block4_conv2', True)
(13, u'block4_conv3', True)
(14, u'block4_pool', True)
(15, u'block5_conv1', True)
(16, u'block5_conv2', True)
(17, u'block5_conv3', True)
(18, u'block5_pool', True)
(19, u'flatten_1', True)
(20, u'dense_1', True)
(21, u'dropout_1', True)
(22, u'dense_2', True)
(23, u'dropout_2', True)
(24, u'dense_3', True)
learning rate :5e-05
Epoch 00000: val_loss improved from inf to 0.09638, saving model to D:/Downloads/amazon/bottleneck/vgg16/frozen11_20170720-065517.h5
Epoch 00000: val_loss improved from inf to 0.09638, saving model to D:/Downloads/amazon/bottleneck/vgg16/frozen11_20170720-065517_weights_only.h5
Epoch 00001: val_loss improved from 0.09638 to 0.09372, saving model to D:/Downloads/amazon/bottleneck/vgg16/frozen11_20170720-065517.h5
Epoch 00001: val_loss improved from 0.09638 to 0.09372, saving model to D:/Downloads/amazon/bottleneck/vgg16/frozen11_20170720-065517_weights_only.h5
Epoch 00002: val_loss improved from 0.09372 to 0.08937, saving model to D:/Downloads/amazon/bottleneck/vgg16/frozen11_20170720-065517.h5
Epoch 00002: val_loss improved from 0.09372 to 0.08937, saving model to D:/Downloads/amazon/bottleneck/vgg16/frozen11_20170720-065517_weights_only.h5
Epoch 00003: val_loss did not improve
Epoch 00003: val_loss did not improve
Epoch 00004: val_loss did not improve
Epoch 00004: val_loss did not improve
learning rate :1e-05
Epoch 00000: val_loss improved from 0.08937 to 0.08645, saving model to D:/Downloads/amazon/bottleneck/vgg16/frozen11_20170720-065517.h5
Epoch 00000: val_loss improved from 0.08937 to 0.08645, saving model to D:/Downloads/amazon/bottleneck/vgg16/frozen11_20170720-065517_weights_only.h5
Epoch 00001: val_loss did not improve
Epoch 00001: val_loss did not improve
Epoch 00002: val_loss did not improve
Epoch 00002: val_loss did not improve
learning rate :2e-06
Epoch 00000: val_loss did not improve
Epoch 00000: val_loss did not improve
Epoch 00001: val_loss did not improve
Epoch 00001: val_loss did not improve
Epoch 00002: val_loss did not improve
Epoch 00002: val_loss did not improve
vgg16 model training complete. Time taken: 2:34:12.116000
loading model file: D:/Downloads/amazon/bottleneck/vgg16/frozen11_20170720-065517.h5
label:0 threshold:0.64 score:0.908579085359
label:1 threshold:0.09 score:0.912250038789
label:2 threshold:0.3 score:0.912347569609
label:3 threshold:0.2 score:0.915320427598
label:4 threshold:0.25 score:0.91765901349
label:5 threshold:0.48 score:0.91765901349
label:6 threshold:0.22 score:0.920049968989
label:7 threshold:0.45 score:0.920505640558
label:8 threshold:0.25 score:0.921881592898
label:9 threshold:0.11 score:0.923484436043
label:10 threshold:0.06 score:0.923734811642
label:11 threshold:0.23 score:0.925203955592
label:12 threshold:0.28 score:0.925499602069
label:13 threshold:0.19 score:0.925685224737
label:14 threshold:0.24 score:0.928769338141
label:15 threshold:0.23 score:0.930513656753
label:16 threshold:0.42 score:0.930540295077
('>>>> Overall precision score over validation set ', 0.87980748870694514)
('>>>> Overall recall score over validation set ', 0.95499100084697919)
('>>>> Overall F2 score over validation set ', 0.93054029507655656)
                label  optimized_threshold
0          slash_burn                 0.64
1               clear                 0.09
2            blooming                 0.30
3             primary                 0.20
4              cloudy                 0.25
5   conventional_mine                 0.48
6               water                 0.22
7                haze                 0.45
8         cultivation                 0.25
9       partly_cloudy                 0.11
10     artisinal_mine                 0.06
11         habitation                 0.23
12        bare_ground                 0.28
13          blow_down                 0.19
14        agriculture                 0.24
15               road                 0.23
16  selective_logging                 0.42
                label    f2  recall  precision  true_sum  predict_sum
0          slash_burn  0.00    0.00       0.00        24            0
1               clear  0.98    0.99       0.93      2873         3077
2            blooming  0.28    0.26       0.37        27           19
3             primary  0.99    0.99       0.97      3759         3849
4              cloudy  0.90    0.96       0.71       199          272
5   conventional_mine  0.56    0.57       0.50         7            8
6               water  0.84    0.87       0.73       716          854
7                haze  0.77    0.77       0.73       262          277
8         cultivation  0.68    0.78       0.46       451          766
9       partly_cloudy  0.94    0.97       0.85       714          814
10     artisinal_mine  0.88    0.94       0.69        35           48
11         habitation  0.77    0.82       0.62       346          456
12        bare_ground  0.38    0.38       0.38       102          103
13          blow_down  0.27    0.23       0.75        13            4
14        agriculture  0.90    0.94       0.78      1251         1511
15               road  0.87    0.91       0.75       789          951
16  selective_logging  0.29    0.29       0.32        28           25
submission file generated: D:/Downloads/amazon/my_submissions/submission_vgg16_20170720-065517.csv
