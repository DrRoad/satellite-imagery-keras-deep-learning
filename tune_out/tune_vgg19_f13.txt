reading configurations from config file: cfg/tune_vgg19_f13.cfg
model: vgg19
number of frozen layers: 13
[5e-05, 1e-05]
[100, 10]
batch size: 16
(40479L, 224L, 224L, 3L)
(40479L, 17L)
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to                     
====================================================================================================
zeropadding2d_1 (ZeroPadding2D)  (None, 3, 226, 226)   0           zeropadding2d_input_1[0][0]      
____________________________________________________________________________________________________
convolution2d_1 (Convolution2D)  (None, 64, 224, 224)  1792        zeropadding2d_1[0][0]            
____________________________________________________________________________________________________
zeropadding2d_2 (ZeroPadding2D)  (None, 64, 226, 226)  0           convolution2d_1[0][0]            
____________________________________________________________________________________________________
convolution2d_2 (Convolution2D)  (None, 64, 224, 224)  36928       zeropadding2d_2[0][0]            
____________________________________________________________________________________________________
maxpooling2d_1 (MaxPooling2D)    (None, 64, 112, 112)  0           convolution2d_2[0][0]            
____________________________________________________________________________________________________
zeropadding2d_3 (ZeroPadding2D)  (None, 64, 114, 114)  0           maxpooling2d_1[0][0]             
____________________________________________________________________________________________________
convolution2d_3 (Convolution2D)  (None, 128, 112, 112) 73856       zeropadding2d_3[0][0]            
____________________________________________________________________________________________________
zeropadding2d_4 (ZeroPadding2D)  (None, 128, 114, 114) 0           convolution2d_3[0][0]            
____________________________________________________________________________________________________
convolution2d_4 (Convolution2D)  (None, 128, 112, 112) 147584      zeropadding2d_4[0][0]            
____________________________________________________________________________________________________
maxpooling2d_2 (MaxPooling2D)    (None, 128, 56, 56)   0           convolution2d_4[0][0]            
____________________________________________________________________________________________________
zeropadding2d_5 (ZeroPadding2D)  (None, 128, 58, 58)   0           maxpooling2d_2[0][0]             
____________________________________________________________________________________________________
convolution2d_5 (Convolution2D)  (None, 256, 56, 56)   295168      zeropadding2d_5[0][0]            
____________________________________________________________________________________________________
zeropadding2d_6 (ZeroPadding2D)  (None, 256, 58, 58)   0           convolution2d_5[0][0]            
____________________________________________________________________________________________________
convolution2d_6 (Convolution2D)  (None, 256, 56, 56)   590080      zeropadding2d_6[0][0]            
____________________________________________________________________________________________________
zeropadding2d_7 (ZeroPadding2D)  (None, 256, 58, 58)   0           convolution2d_6[0][0]            
____________________________________________________________________________________________________
convolution2d_7 (Convolution2D)  (None, 256, 56, 56)   590080      zeropadding2d_7[0][0]            
____________________________________________________________________________________________________
zeropadding2d_8 (ZeroPadding2D)  (None, 256, 58, 58)   0           convolution2d_7[0][0]            
____________________________________________________________________________________________________
convolution2d_8 (Convolution2D)  (None, 256, 56, 56)   590080      zeropadding2d_8[0][0]            
____________________________________________________________________________________________________
maxpooling2d_3 (MaxPooling2D)    (None, 256, 28, 28)   0           convolution2d_8[0][0]            
____________________________________________________________________________________________________
zeropadding2d_9 (ZeroPadding2D)  (None, 256, 30, 30)   0           maxpooling2d_3[0][0]             
____________________________________________________________________________________________________
convolution2d_9 (Convolution2D)  (None, 512, 28, 28)   1180160     zeropadding2d_9[0][0]            
____________________________________________________________________________________________________
zeropadding2d_10 (ZeroPadding2D) (None, 512, 30, 30)   0           convolution2d_9[0][0]            
____________________________________________________________________________________________________
convolution2d_10 (Convolution2D) (None, 512, 28, 28)   2359808     zeropadding2d_10[0][0]           
____________________________________________________________________________________________________
zeropadding2d_11 (ZeroPadding2D) (None, 512, 30, 30)   0           convolution2d_10[0][0]           
____________________________________________________________________________________________________
convolution2d_11 (Convolution2D) (None, 512, 28, 28)   2359808     zeropadding2d_11[0][0]           
____________________________________________________________________________________________________
zeropadding2d_12 (ZeroPadding2D) (None, 512, 30, 30)   0           convolution2d_11[0][0]           
____________________________________________________________________________________________________
convolution2d_12 (Convolution2D) (None, 512, 28, 28)   2359808     zeropadding2d_12[0][0]           
____________________________________________________________________________________________________
maxpooling2d_4 (MaxPooling2D)    (None, 512, 14, 14)   0           convolution2d_12[0][0]           
____________________________________________________________________________________________________
zeropadding2d_13 (ZeroPadding2D) (None, 512, 16, 16)   0           maxpooling2d_4[0][0]             
____________________________________________________________________________________________________
convolution2d_13 (Convolution2D) (None, 512, 14, 14)   2359808     zeropadding2d_13[0][0]           
____________________________________________________________________________________________________
zeropadding2d_14 (ZeroPadding2D) (None, 512, 16, 16)   0           convolution2d_13[0][0]           
____________________________________________________________________________________________________
convolution2d_14 (Convolution2D) (None, 512, 14, 14)   2359808     zeropadding2d_14[0][0]           
____________________________________________________________________________________________________
zeropadding2d_15 (ZeroPadding2D) (None, 512, 16, 16)   0           convolution2d_14[0][0]           
____________________________________________________________________________________________________
convolution2d_15 (Convolution2D) (None, 512, 14, 14)   2359808     zeropadding2d_15[0][0]           
____________________________________________________________________________________________________
zeropadding2d_16 (ZeroPadding2D) (None, 512, 16, 16)   0           convolution2d_15[0][0]           
____________________________________________________________________________________________________
convolution2d_16 (Convolution2D) (None, 512, 14, 14)   2359808     zeropadding2d_16[0][0]           
____________________________________________________________________________________________________
maxpooling2d_5 (MaxPooling2D)    (None, 512, 7, 7)     0           convolution2d_16[0][0]           
____________________________________________________________________________________________________
flatten_1 (Flatten)              (None, 25088)         0           maxpooling2d_5[0][0]             
____________________________________________________________________________________________________
sequential_2 (Sequential)        (None, 17)            1558545     dense_3[0][0]                    
====================================================================================================
Total params: 21,582,929
Trainable params: 21,027,601
Non-trainable params: 555,328
____________________________________________________________________________________________________
None
(0, 'zeropadding2d_1', False)
(1, 'convolution2d_1', False)
(2, 'zeropadding2d_2', False)
(3, 'convolution2d_2', False)
(4, 'maxpooling2d_1', False)
(5, 'zeropadding2d_3', False)
(6, 'convolution2d_3', False)
(7, 'zeropadding2d_4', False)
(8, 'convolution2d_4', False)
(9, 'maxpooling2d_2', False)
(10, 'zeropadding2d_5', False)
(11, 'convolution2d_5', False)
(12, 'zeropadding2d_6', False)
(13, 'convolution2d_6', True)
(14, 'zeropadding2d_7', True)
(15, 'convolution2d_7', True)
(16, 'zeropadding2d_8', True)
(17, 'convolution2d_8', True)
(18, 'maxpooling2d_3', True)
(19, 'zeropadding2d_9', True)
(20, 'convolution2d_9', True)
(21, 'zeropadding2d_10', True)
(22, 'convolution2d_10', True)
(23, 'zeropadding2d_11', True)
(24, 'convolution2d_11', True)
(25, 'zeropadding2d_12', True)
(26, 'convolution2d_12', True)
(27, 'maxpooling2d_4', True)
(28, 'zeropadding2d_13', True)
(29, 'convolution2d_13', True)
(30, 'zeropadding2d_14', True)
(31, 'convolution2d_14', True)
(32, 'zeropadding2d_15', True)
(33, 'convolution2d_15', True)
(34, 'zeropadding2d_16', True)
(35, 'convolution2d_16', True)
(36, 'maxpooling2d_5', True)
(37, 'flatten_1', True)
(38, 'sequential_2', True)
learning rate :5e-05
Epoch 00000: val_loss improved from inf to 0.10514, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101.h5
Epoch 00000: val_loss improved from inf to 0.10514, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101_weights_only.h5
Epoch 00001: val_loss improved from 0.10514 to 0.09587, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101.h5
Epoch 00001: val_loss improved from 0.10514 to 0.09587, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101_weights_only.h5
Epoch 00002: val_loss improved from 0.09587 to 0.09385, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101.h5
Epoch 00002: val_loss improved from 0.09587 to 0.09385, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101_weights_only.h5
Epoch 00003: val_loss improved from 0.09385 to 0.09296, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101.h5
Epoch 00003: val_loss improved from 0.09385 to 0.09296, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101_weights_only.h5
Epoch 00004: val_loss improved from 0.09296 to 0.09217, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101.h5
Epoch 00004: val_loss improved from 0.09296 to 0.09217, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101_weights_only.h5
Epoch 00005: val_loss improved from 0.09217 to 0.09164, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101.h5
Epoch 00005: val_loss improved from 0.09217 to 0.09164, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101_weights_only.h5
Epoch 00006: val_loss improved from 0.09164 to 0.09080, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101.h5
Epoch 00006: val_loss improved from 0.09164 to 0.09080, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101_weights_only.h5
Epoch 00007: val_loss improved from 0.09080 to 0.09004, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101.h5
Epoch 00007: val_loss improved from 0.09080 to 0.09004, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101_weights_only.h5
Epoch 00008: val_loss did not improve
Epoch 00008: val_loss did not improve
Epoch 00009: val_loss did not improve
Epoch 00009: val_loss did not improve
learning rate :1e-05
Epoch 00000: val_loss improved from 0.09004 to 0.08659, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101.h5
Epoch 00000: val_loss improved from 0.09004 to 0.08659, saving model to D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101_weights_only.h5
Epoch 00001: val_loss did not improve
Epoch 00001: val_loss did not improve
Epoch 00002: val_loss did not improve
Epoch 00002: val_loss did not improve
vgg19 model training complete. Time taken: 5:36:53.873000
loading model weights file: D:/Downloads/amazon/bottleneck/vgg19/frozen13_20170718-183101_weights_only.h5
label:0 threshold:0.03 score:0.746371928323
label:1 threshold:0.59 score:0.746711442265
label:2 threshold:0.03 score:0.746711442265
label:3 threshold:0.0 score:0.746711442265
label:4 threshold:0.01 score:0.771953831506
label:5 threshold:0.06 score:0.771953831506
label:6 threshold:0.35 score:0.796824656812
label:7 threshold:0.09 score:0.810954912616
label:8 threshold:0.13 score:0.820550539872
label:9 threshold:0.22 score:0.842674701284
label:10 threshold:0.03 score:0.843608810622
label:11 threshold:0.08 score:0.852883158091
label:12 threshold:0.11 score:0.85316875969
label:13 threshold:0.06 score:0.85316875969
label:14 threshold:0.53 score:0.859406395129
label:15 threshold:0.21 score:0.880360707611
label:16 threshold:0.05 score:0.880360707611
('>>>> Overall precision score over validation set ', 0.78345430234017199)
('>>>> Overall recall score over validation set ', 0.93604925418784113)
('>>>> Overall F2 score over validation set ', 0.88036070761089857)
                label  optimized_threshold
0          slash_burn                 0.03
1               clear                 0.59
2            blooming                 0.03
3             primary                 0.00
4              cloudy                 0.01
5   conventional_mine                 0.06
6               water                 0.35
7                haze                 0.09
8         cultivation                 0.13
9       partly_cloudy                 0.22
10     artisinal_mine                 0.03
11         habitation                 0.08
12        bare_ground                 0.11
13          blow_down                 0.06
14        agriculture                 0.53
15               road                 0.21
16  selective_logging                 0.05
                label    f2  recall  precision  true_sum  predict_sum
0          slash_burn  0.05    0.04       0.20        24            5
1               clear  0.96    0.99       0.87      2873         3274
2            blooming  0.00    0.00       0.00        27            0
3             primary  0.98    1.00       0.93      3759         4048
4              cloudy  0.53    0.95       0.19       199         1004
5   conventional_mine  0.00    0.00       0.00         7            0
6               water  0.71    0.73       0.66       716          788
7                haze  0.71    0.87       0.41       262          551
8         cultivation  0.61    0.73       0.36       451          902
9       partly_cloudy  0.90    0.95       0.76       714          884
10     artisinal_mine  0.60    0.60       0.62        35           34
11         habitation  0.72    0.79       0.53       346          516
12        bare_ground  0.20    0.21       0.19       102          111
13          blow_down  0.00    0.00       0.00        13            0
14        agriculture  0.80    0.84       0.70      1251         1501
15               road  0.84    0.88       0.73       789          952
16  selective_logging  0.00    0.00       0.00        28            0
